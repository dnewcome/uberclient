(function(){tinymce.PluginManager.requireLangPack("checkbox");tinymce.create("tinymce.plugins.Checkbox",{init:function(a,b){var c=this,d=c.editor=a;a.addCommand("mceCheckbox",function(){c.createContent()});a.onClick.add(c.OnClick,c);a.onCheckBoxChange=new tinymce.util.Dispatcher(a);a.addButton("checkbox",{title:"checkbox.desc",cmd:"mceCheckbox","class":"elementUncheck"});a.onPreInit.add(this.editorPreInit,this);a.onNodeChange.add(this.updateButton,this)},editorPreInit:function(a){a.editorCommands._queryStateInsertUnorderedList=a.editorCommands.queryStateInsertUnorderedList;a.editorCommands.queryStateInsertUnorderedList=this.queryStateInsertUnorderedList;a.editorCommands._origQueryStateOutdent=a.editorCommands.queryStateOutdent;a.editorCommands.queryStateOutdent=this.queryStateOutdent;a.addQueryStateHandler("mceCheckbox",this.queryStateInsertCheckboxList,a.editorCommands);a.editorCommands.queryStateInsertCheckboxList=this.queryStateInsertCheckboxList},queryStateOutdent:function(){return this.queryStateInsertCheckboxList()||this._origQueryStateOutdent()},queryStateInsertUnorderedList:function(){var a=this.editor;var b=a.selection.getNode();var c=a.dom.getParent(b,"UL");return((c)&&(!a.dom.hasClass(c,"uberCheckboxList")))},queryStateInsertCheckboxList:function(){var a=this.editor;var b=a.selection.getNode();var c=a.dom.getParent(b,"UL");return((c)&&(a.dom.hasClass(c,"uberCheckboxList")))},updateButton:function(b,a,g,e){var f;if(f=a.get("checkbox")){var d=b.editorCommands.queryStateInsertCheckboxList?b.editorCommands.queryStateInsertCheckboxList.call(this):false;f.setActive(d)}},createContent:function(){var c=this,b=c.editor,d=b.selection.getContent();var a=c._convertToList(d,"checkboxUnselected");a='<ul id="uberSelect" class="uberCheckboxList">'+a+"</ul>";b.selection.setContent(a);setTimeout(function(){c.createContentContinuation()},100)},createContentContinuation:function(){var b=this,a=b.editor,d=a.getDoc();var c=d.getElementById("uberSelect");if(c){c.id="";a.selection.select(c,true)}a.nodeChanged();a.onCheckBoxChange.dispatch()},OnClick:function(a,d){var b=this,c=DOMEvent(d).target;if((true==b._isCheckboxElement(c))&&(true==b._clickedOnCheckbox(d))){if(true==a.dom.hasClass(c,"checkboxSelected")){a.dom.addClass(c,"checkboxUnselected");a.dom.removeClass(c,"checkboxSelected")}else{a.dom.addClass(c,"checkboxSelected");a.dom.removeClass(c,"checkboxUnselected")}a.nodeChanged();a.onCheckBoxChange.dispatch()}},_isCheckboxElement:function(a){var b=((true==DOMElement.isTagType(a,"li"))&&(true==DOMElement.ancestorHasClassName(a,"uberCheckboxList")));return b},_clickedOnCheckbox:function(g){var e=this,c=e.editor;var f=false;var d=g.target;var h=parseInt(c.dom.getStyle(d,"margin-left"),10)||20;var a=Position.cumulativeOffset(d);var b=Event.pointer(g);f=((b.x>=(a[0]-h))&&(b.x<=a[0]));return f},_convertToList:function(b,d){Util.Assert(TypeCheck.String(b));var f=this,e=f.editor;var c=b.replace(/[\r\n]+/gi,"");c=c.replace(/<br[^>]*>/gi,"<MCE_LI>");c=c.replace(/<li[^>]*>(&nbsp;)+<\/li>/gi,"");c=c.replace(/<li[^>]*>[\t ]+<\/li>/gi,"");c=c.replace(/<li[^>]*>/gi,"<MCE_LI>");c=c.replace(/<\/li>/gi,"");c=c.replace(/<p[^>]*><\/p>/gi,"");c=c.replace(/<p[^>]*>(&nbsp;)+<\/p>/gi,"");c=c.replace(/<p[^>]*>[\t ]+<\/p>/gi,"");c=c.replace(/<p[^>]*>/gi,"<MCE_LI>");c=c.replace(/<\/p>/gi,"");if(!c){c=e.translate("checkbox.insert_item")}var a="<li>";if(d){a='<li class="'+d+'">'}c=a+c.replace(/<MCE_LI>/g,"</li>"+a)+"</li>";c=c.replace(/<li[^>]*><\/li>/g,"");return c},getInfo:function(){return{longname:"Selectable Checkbox",author:"Ubernote/Shane Tomlinson",authorurl:"http://www.ubernote.com",infourl:"http://www.ubernote.com",version:"0.1"}}});tinymce.PluginManager.add("checkbox",tinymce.plugins.Checkbox)})();